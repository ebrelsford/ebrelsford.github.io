<!DOCTYPE html>
<html>
    <head>
        <title>Class 11 | Methods 3</title>
        <meta charset="utf-8"> 
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />

        <link href='http://fonts.googleapis.com/css?family=Arvo' rel='stylesheet' type='text/css'>
        <link href='http://fonts.googleapis.com/css?family=Alegreya Sans' rel='stylesheet' type='text/css'>

        <link href="css/pig.css" rel="stylesheet" type="text/css" />
        <link href="css/base.css" rel="stylesheet" />

        <script src="js/pig.js"></script>
    </head>
    <body>

        <div class="slide">
            <p>Welcome to Methods 3, Lecture 11</p>
            <p>This is a web page that can be viewed as slides.</p>
            <p>→ to move forward</p>
            <p>← to go back</p>
        </div>

        <div class="slide">
            <h1>Methods 3</h1>
        </div>

        <div class="slide intermission"></div>

        <div class="slide">
            <h2>custom base maps</h2>
        </div>

        <div class="slide" style="background-image: url(img/mapbox-studio.png);">
        </div>

        <div class="slide" style="background-image: url(img/custom_basemap_cartodb.png);">
        </div>

        <div class="slide">
            <h2>creating data</h2>
        </div>

        <div class="slide" style="background-image: url(img/qgis_satellite.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis-new-layer.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis_new_shapefile_layer.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis-edit-toolbar.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis_new_feature.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis_new_feature_added.png);">
        </div>

        <div class="slide">
            <h2>in CartoDB</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb_new_dataset.png);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb_new_from_scratch.png);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb_add_column.png);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb_add.gif);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb_edit.gif);">
        </div>

        <div class="slide">
            <h2>splitting columns</h2>
        </div>

        <div class="slide" style="background-image: url(img/openrefine.png);">
            <a href="http://openrefine.org/" class="source">openrefine.org</a>
        </div>

        <div class="slide">
            <h2>converting columns</h2>
        </div>

        <div class="slide" style="background-image: url(img/qgis_string.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis_string_to_int.png);">
        </div>

        <div class="slide" style="background-image: url(img/qgis_int.png);">
        </div>

        <div class="slide">
            <code>to_int( [field_name] )</code>
        </div>

        <div class="slide">
            <code>to_int( [field_name] )</code>
            <h2>converts text to integers</h2>
        </div>

        <div class="slide">
            <code>to_real( [field_name] )</code>
        </div>

        <div class="slide">
            <code>to_real( [field_name] )</code>
            <h2>converts text to decimal numbers</h2>
        </div>

        <div class="slide">
            <h2>sql</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-filters.png);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb-filters-specific.gif);">
        </div>

        <div class="slide">
            <h2>but I wanted <strong>6.5</strong>!</h2>
        </div>

        <div class="slide">
            <h2>SQL</h2>
        </div>

        <div class="slide">
            <h2>SQL</h2>
            <h2>Structured Query Language</h2>
        </div>

        <div class="slide">
            <h2>SQL</h2>
            <h2>the language databases understand</h2>
        </div>

        <div class="slide">
            <h2>you'll use SQL in two ways:</h2>
        </div>

        <div class="slide">
            <h2>1. pulling data out of the database</h2>
        </div>

        <div class="slide">
            <h2>2. changing the data in the database</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-table.png);">
        </div>

        <div class="slide">
            <img style="float: left; max-width: 50%;" src="img/paper.jpg" />
        </div>

        <div class="slide">
            <img style="float: left; max-width: 50%;" src="img/paper.jpg" />
            <div style="float: left; width: 50%;">
                <div style="margin-left: 25px;">
                    <p>Give me the pages that refer to properties in Brooklyn.</p>
                </div>
            </div>
        </div>

        <div class="slide">
            <img style="float: left; max-width: 50%;" src="img/paper.jpg" />
            <div style="float: left; width: 50%;">
                <div style="margin-left: 25px;">
                    <p>Give me the addresses of the properties in Brooklyn.</p>
                </div>
            </div>
        </div>

        <div class="slide">
            <img style="float: left; max-width: 50%;" src="img/paper.jpg" />
            <div style="float: left; width: 50%;">
                <div style="margin-left: 25px;">
                    <p>Give me the addresses of the properties in Brooklyn that have been built on since 1950.</p>
                </div>
            </div>
        </div>

        <div class="slide">
            <h2>databases are great at these types of questions</h2>
        </div>

        <div class="slide">
            <h2>it's what they were made for</h2>
        </div>

        <div class="slide">
            <h2>SQL helps you ask these questions in a way databases understand</h2>
        </div>

        <div class="slide">
            <h2>Carto<strong>DB</strong></h2>
        </div>

        <div class="slide">
            <h2>Carto<strong>DB</strong> is a database</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-table.png);">
        </div>

        <div class="slide" style="background-image: url(img/cartodb-table-select.png);">
        </div>

        <div class="slide">
            <h2><span class="code">SELECT</span>: choose columns from a table</h2>
        </div>

        <div class="slide">
            <p>just list the columns. for example:</p>
            <pre>SELECT students, teachers
FROM education</pre>
        </div>

        <div class="slide">
            <h2><span class="code">SELECT *</span>: choose <strong>all</strong> columns</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-table-where.png);">
        </div>

        <div class="slide">
            <h2><span class="code">WHERE</span>: choose rows from a table</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-table-select-and-where.png);">
        </div>

        <div class="slide">
            <p>these conditions are the same as the ones in CartoCSS:</p>
            <pre style="margin-left: 250px;">&gt;
&lt;
=
!=
&gt;=
&lt;=</pre>
        </div>

        <div class="slide">
            <p>for example:</p>
            <pre>SELECT *
FROM education
WHERE students &gt; 100</pre>
        </div>

        <div class="slide">
            <h2>and you combine them with <span class="code">AND</span> / <span class="code">OR</span></h2>
        </div>

        <div class="slide">
            <p>for example:</p>
            <pre>SELECT *
FROM education
WHERE students &gt; 100 
    AND students &lt; 200</pre>
        </div>

        <div class="slide">
            <h2>try it yourself</h2>
            <p>filter a numeric column by a range (eg, 0 to 50)</p>
        </div>

        <div class="slide">
            <h2>or you can negate a condition with <span class="code">NOT</span></h2>
        </div>

        <div class="slide">
            <p>for example:</p>
            <pre>SELECT *
FROM education
WHERE NOT (students &gt; 100 
  OR op_type = 'religious')</pre>
        </div>

        <div class="slide">
            <h2>try it yourself</h2>
            <p>negate your numeric column filter</p>
        </div>

        <div class="slide" style="background-image: url(img/qgis_expressions.png);">
        </div>

        <div class="slide">
            <h2><span class="code">SELECT</span> does not change the table, it only changes your view of the table</h2>
        </div>

        <div class="slide" style="background-image: url(img/playdoh-pasta.jpg);">
        </div>

        <div class="slide" style="background-image: url(img/playdoh-smoosh.jpg);">
        </div>

        <div class="slide">
            <h2>you can also use <span class="code">SELECT</span> to get a better idea of what data is in your table</h2>
        </div>

        <div class="slide">
            <p>count matching rows:</p>
            <pre>SELECT COUNT(*)
FROM education
WHERE students &gt; 100 
  OR op_type = 'religious'</pre>
        </div>

        <div class="slide">
            <h2>but you'll almost never want to use this statement for your map</h2>
        </div>

        <div class="slide" style="background-image: url(img/cartodb-filters-nogeom.gif);">
        </div>

        <div class="slide">
            <h2>try it yourself</h2>
            <p>get the number of features matching your filters</p>
        </div>

        <div class="slide">
            <h2><code>SELECT</code> trick: <strong>add "columns"</strong> to your selection</h2>
        </div>

        <div class="slide">
            <pre>SELECT *, 5
FROM education</pre>
        </div>

        <div class="slide">
            <pre>SELECT *, stdnt_fem / students
FROM education</pre>
        </div>

        <div class="slide">
            <pre>SELECT *,
    (stdnt_fem / students) * 100
FROM education</pre>
        </div>

        <div class="slide">
            <pre>SELECT *,
    (stdnt_fem / students) * 100
    AS stdnt_fem_per
FROM education</pre>
        </div>

        <div class="slide">
            <h2 style="text-decoration: line-through;">1. pulling data out of the database</h2>
            <h2>2. changing the data in the database</h2>
        </div>

        <div class="slide">
            <h2>you can also use SQL to quickly <span class="code">UPDATE</span> or <span class="code">DELETE</span> the data in your table</h2>
        </div>

        <div class="slide">
            <h2>these <strong>will</strong> destroy data, so have a backup or test it with a table you don't need</h2>
        </div>

        <div class="slide">
            <h2>this is one way to customize the way data is displayed in your infowindow</h2>
        </div>

        <div class="slide">
            <h2>first, create a new column on your table</h2>
        </div>

        <div class="slide">
            <h2>then put the desired data in that column, based on some condition</h2>
        </div>

        <div class="slide">
            <pre>UPDATE education
SET size = 'large'
WHERE students &gt; 2500</pre>
        </div>

        <div class="slide">
            <pre>DELETE FROM education
WHERE ...</pre>
        </div>

        <div class="slide">
            <h2>more in the SQL reference</h2>
        </div>

        <div class="slide" style="background-image: url(img/sql_cheatsheet.png);">
            <h2>more in the SQL reference</h2>
            <a href="materials/sql-cheatsheet.pdf" class="source">source</a>
        </div>

    </body>
</html>
